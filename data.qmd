# Data {#data}

This chapter describes the datasets used throughout the book, one possibility is that this could be moved to an appendix and in the online version of the book any mention of the dataset in the main text could be cross-linked to its description. One thing that I really liked in the first edition is the emphasis on analysis
question of interest and the little notes about the data. I believe the original layout was to put the data in order of appearance of the book, which naturally clusters them by technique.

```{r}
#| message: false
#| echo: false
library(gt)
library(gtExtras)
library(gtsummary)
library(readr)
datasets <- read_csv("misc/datasets.csv") %>% select(-`Other Notes`)
datasets %>% gt() %>% cols_width(Name~px(100), 
                                 Description~px(300),
                                 Source~px(150), 
                                 Analysis~px(100))
```


## Australian Football League Women

### Description {.unnumbered}

The `aflw` data is from the 2021 Women's Australian Football League. These are average player statistics across the season, with game statistics provided by the [fitzRoy](https://jimmyday12.github.io/fitzRoy/) package. If you are new to the game of AFL, there is a nice explanation on [Wikipedia](https://en.wikipedia.org/wiki/Women%27s_Australian_rules_football). 

### Variables {.unnumbered}

```{r}
#| label: load-data-libraries
#| echo: FALSE
#| message: FALSE
#| warning: FALSE
library(mulgar)
library(dplyr)
```

```{r}
#| label: data-aflw
#| echo: FALSE
#| message: FALSE
#| warning: FALSE
data(aflw)
glimpse(aflw)
```

### Purpose {.unnumbered}

The primary analysis is to summarise the variation using principal component analysis, which gives information about relationships between the statistics or skills sets common in players. One also might be tempted to cluster the players, but there are no obvious clusters so it could be frustrating. At best one could partition the players into groups, while recognising there are no absolutely distinct and separated groups.

### Source {.unnumbered}

See the information provided with the [fitzRoy](https://jimmyday12.github.io/fitzRoy/) package.

### Pre-processing {.unnumbered}

The code for downloading and pre-processing the data is available at the [mulgar](https://dicook.github.io/mulgar/) website in the `data-raw` folder. The data provided by the fitzRoy package was pre-processed to reduce the variables to only those that relate to player skills and performance. It is possible that using some transformations on the variables would be useful to make them less skewed. 

## Palmer penguins

```{r}
#| label: penguins
#| message: FALSE
#| eval: FALSE
library(palmerpenguins)
penguins <- penguins %>%
  na.omit() # 11 observations out of 344 removed
# use only vars of interest, and standardise
# them for easier interpretation
penguins_sub <- penguins[,c(1, 3:6)] %>% 
  mutate(across(where(is.numeric),  ~ scale(.)[,1])) %>%
  rename(bl = bill_length_mm,
         bd = bill_depth_mm,
         fl = flipper_length_mm,
         bm = body_mass_g)
save(penguins_sub, file="data/penguins_sub.rda")
```

### Description {.unnumbered}

This data measure four physical characteristics of three species of penguins.  

### Variables {.unnumbered}

|Name      | Description     |
|:---------|:----------------|
|`bl`      | a number denoting bill length (millimeters) |
`bd`      | a number denoting bill depth (millimeters) |
|`fl`      | an integer denoting flipper length (millimeters) |
|`bm`      | an integer denoting body mass (grams) |
|`species` | a factor denoting penguin species (Ad√©lie, Chinstrap and Gentoo) |

### Purpose {.unnumbered}

The primary goal is to find a combination of the four variables where the three species are distinct. This is also a useful data set to illustrate cluster analysis.

### Source {.unnumbered}

Details of the penguins data can be found at [https://allisonhorst.github.io/palmerpenguins/](https://allisonhorst.github.io/palmerpenguins/), and @penguins is the package source.

### Pre-processing {.unnumbered}

The data is loaded from the `palmerpenguins` package. The four physical measurement variables and the species are selected, and the penguins with missing values are removed. Variables are standardised, and their names are shortened.


```{r}
#| label: penguins_echo
#| message: FALSE
#| eval: FALSE
#| echo: TRUE
#| code-fold: FALSE
library(palmerpenguins)
penguins <- penguins %>%
  na.omit() # 11 observations out of 344 removed
# use only vars of interest, and standardise
# them for easier interpretation
penguins_sub <- penguins[,c(3:6, 1)] %>% 
  mutate(across(where(is.numeric),  ~ scale(.)[,1])) %>%
  rename(bl = bill_length_mm,
         bd = bill_depth_mm,
         fl = flipper_length_mm,
         bm = body_mass_g) %>%
  as.data.frame()
save(penguins_sub, file="data/penguins_sub.rda")
```

## Bushfires

### Description {.unnumbered}

This data was collated by Weihao (Patrick) Li as part of his Honours research at Monash University. It contains fire ignitions as detected from satellite hotspots, and processed using the [spotoroo](https://tengmcing.github.io/spotoroo/) package, augmented with measurements on weather, vegetation, proximity to human activity. The cause variable is predicted based on historical fire ignition data collected by County Fire Authority personnel.

### Variables {.unnumbered}

```{r}
#| echo: false
library(mulgar)
data(bushfires)
glimpse(bushfires)
```

### Purpose {.unnumbered}

The primary goal is to predict the cause of the bushfire using the weather and distance from human activity variables provided. 

### Source {.unnumbered}

Collated data was part of Weihao Li's Honours thesis, which is not publicly available. The hotspots data was collected from @jaxa, climate data was taken from the Australian Bureau of Meteorology using the `bomrang` package [@R-bomrang], wind data from @wind and @windasos, vegetation data from @forest, distance from roads calculated using @OpenStreetMap, CFA stations from @cfa, and campsites from @recreation. The cause was predicted from training data provided by @fireorigin.

### Pre-processing {.unnumbered}

The 60 variables are too many to view with a tour, so it should be pre-processed using principal component analysis. The categorical variables of FOR_TYPE and FOR_CAT are removed. It would be possible to keep these if they are converted to dummy (binary variables).


## Program for International Student Assessment 

### Description {.unnumbered}

The `pisa` data contains plausible scores for math, reading and science of Australian and Indonesian students from the 2018 testing cycle.  The plausible scores are simulated from a model fitted to the original data, to preserve privacy of the students.

### Variables {.unnumbered}

|Name      | Description     |
|:---------|:----------------|
|`CNT`      | country, either AUS for Australia or IDN for Indonesia |
|`PV1MATH`-`PV10MATH` | plausible scores for math |
|`PV1READ`-`PV10READ` | plausible scores for reading |
|`PV1SCIE`-`PV10SCIE` | plausible scores for science |

### Purpose {.unnumbered}

Primarily this data is useful as an example for dimension reduction.

### Source {.unnumbered}

The full data is available from https://www.oecd.org/pisa/. There are records of the student test scores, along with survey data from the students, their households and their schools.

### Pre-processing {.unnumbered}

The data was reduced to country and the plausible scores, and filtered to the two countries. It may be helpful to know that the SPSS format data was used, and was read into R using the `read_sav()` function in the `haven` package. 

## Google Quick Draw 

### Description {.unnumbered}

This data is a subset of images from https://quickdraw.withgoogle.com The subset was created using the quickdraw R package at https://huizezhang-sherry.github.io/quickdraw/. It has 6 different groups: banana, boomerang, cactus, flip flops, kangaroo. Each image is 28x28 pixels. The `sketches_train` data would be used to train a classification model, and the unlabelled `sketches_test` can be used for prediction. 

### Variables {.unnumbered}

|Name      | Description     |
|:---------|:----------------|
|`V1-V784`      | grey scale 0-255 |
|`word` | what the person was asked to draw, NA in the test data |
|`id` | unique id for each sketch |

### Purpose {.unnumbered}

Primarily this data is useful as an example for supervised classification, and also dimension reduction.

### Source {.unnumbered}

The full data is available from https://quickdraw.withgoogle.com. 

### Pre-processing {.unnumbered}

It is typically useful to pre-process this data into principal components. This code can also be useful for plotting one of the sketches in a recognisable form:

```{r}
#| code-fold: false
#| label: fig-sketches
#| fig-cap: One of the sketches in the subset of training data.
#| fig-width: 1
#| fig-height: 1
library(mulgar)
library(ggplot2)
data("sketches_train")
set.seed(77)
x <- sketches_train[sample(1:nrow(sketches_train), 1), ]
print(x$word)
xm <- data.frame(gry=t(as.matrix(x[,1:784])),
        x=rep(1:28, 28),
        y=rep(28:1, rep(28, 28)))
ggplot(xm, aes(x=x, y=y, fill=gry)) +
  geom_tile() +
  scale_fill_gradientn(colors = gray.colors(256, start = 0, end = 1, rev = TRUE )) +
  theme_void() + theme(legend.position="none")
```

## Notes to self

There were fifteen datasets listed in chapter 7 of the first edition. Several
of these were related to networks which we are not including this time. I have
tried to give a mix of things on a variety of topics. It would be nice to
see if there's updated versions of the "tips" 
(there seems to be a lot of noise in the literature here and no open datasets) and 
Di's music data (perhaps we could scrape our own spotify accounts to get an equivalent), there are also a few audio challenge datasets like [FSD50K](https://zenodo.org/record/4060432#.YCHksxMzbWY) . I think
it would be useful to have more unstructured data sets like natural text that we have used for 1010.


### Other possible sources for data {-}

There are now many search engines available for datasets that originate
from research contexts that list licensing information and DOIs:

* https://zenodo.org (mostly ecology/biology)
* https://datadryad.org/stash (mostly biology)
* https://dataverse.harvard.edu/dataverse/harvard/ (mostly social sciences, but has a mixture of things)
* There's also a big list of datasets here: https://docs.google.com/spreadsheets/d/1ejOJTNTL5ApCuGTUciV0REEEAqvhI2Rd2FCoj7afops/edit#gid=0 (all psychology related)
* TidyTuesday
    * https://github.com/rfordatascience/tidytuesday/blob/master/data/2022/2022-03-29/readme.md Would need to rearrange data to look at count, participation, revenue, expenditure
* gapminder
* accounting records
* Lyn's ecology data
* learningtower, yowie
