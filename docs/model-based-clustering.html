<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Interactive and dynamic graphics for high-dimensional data using R - 11&nbsp; Model-based clustering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./som.html" rel="next">
<link href="./kmeans-clustering.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model-based clustering</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Interactive and dynamic graphics for high-dimensional data using R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./dimension.html" class="sidebar-item-text sidebar-link">Dimension reduction</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Principal component analysis (PCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nldr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Non-linear dimension reduction</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./supervised.html" class="sidebar-item-text sidebar-link">Supervised learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LDA.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear discriminant analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forests.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Trees and forests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nn.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Neural networks and deep learning</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./unsupervised.html" class="sidebar-item-text sidebar-link">Unsupervised learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./brush-and-spin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Brush-and-spin approach</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hierarchical-clustering.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hierarchical clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kmeans-clustering.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">k-means clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-based-clustering.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model-based clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./som.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Self-organizing maps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unsupervised-summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Comparing methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unsupervised-ex.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./temporal.html" class="sidebar-item-text sidebar-link">Time series</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate-time-series.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multiple time series</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./toolbox.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Toolbox</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Data</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="toc-section-number">11.1</span>  Overview</a></li>
  <li><a href="#two-variables" id="toc-two-variables" class="nav-link" data-scroll-target="#two-variables"><span class="toc-section-number">11.2</span>  Two variables</a></li>
  <li><a href="#high-dimensions" id="toc-high-dimensions" class="nav-link" data-scroll-target="#high-dimensions"><span class="toc-section-number">11.3</span>  High-dimensions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-mclust" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model-based clustering</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p></p>
<section id="overview" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">11.1</span> Overview</h2>
<p>Model-based clustering <span class="citation" data-cites="FR02">Fraley and Raftery (<a href="references.html#ref-FR02" role="doc-biblioref">2002</a>)</span> fits a multivariate normal mixture model to the data. It uses the EM algorithm to fit the parameters for the mean, variance–covariance of each population, and the mixing proportion. The variance-covariance matrix is re-parametrized using an eigen-decomposition</p>
<p><span class="math display">\[
\Sigma_k = \lambda_kD_kA_kD_k', ~~~k=1, \dots, g ~~\mbox{(number of clusters)}
\]</span></p>
<p>resulting in several model choices, ranging from simple to complex, as shown in <a href="#tbl-covariances">Table&nbsp;<span>11.1</span></a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mulgar)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tourr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-covariances" class="anchored">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"><caption>Table&nbsp;11.1:  Parameterizations of the covariance matrix. </caption>
 <thead>
  <tr>
   <th style="text-align:center;"> Model </th>
   <th style="text-align:center;"> Sigma </th>
   <th style="text-align:center;"> Family </th>
   <th style="text-align:center;"> Volume </th>
   <th style="text-align:center;"> Shape </th>
   <th style="text-align:center;"> Orientation </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> EII </td>
   <td style="text-align:center;"> $$\lambda I$$ </td>
   <td style="text-align:center;"> Spherical </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> VII </td>
   <td style="text-align:center;"> $$\lambda_k I$$ </td>
   <td style="text-align:center;"> Spherical </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> EEI </td>
   <td style="text-align:center;"> $$\lambda A$$ </td>
   <td style="text-align:center;"> Diagonal </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Coordinate axes </td>
  </tr>
  <tr>
   <td style="text-align:center;"> VEI </td>
   <td style="text-align:center;"> $$\lambda_kA$$ </td>
   <td style="text-align:center;"> Diagonal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Coordinate axes </td>
  </tr>
  <tr>
   <td style="text-align:center;"> EVI </td>
   <td style="text-align:center;"> $$\lambda A_k$$ </td>
   <td style="text-align:center;"> Diagonal </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Coordinate axes </td>
  </tr>
  <tr>
   <td style="text-align:center;"> VVI </td>
   <td style="text-align:center;"> $$\lambda_k A_k$$ </td>
   <td style="text-align:center;"> Diagonal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Coordinate axes </td>
  </tr>
  <tr>
   <td style="text-align:center;"> EEE </td>
   <td style="text-align:center;"> $$\lambda DAD^T$$ </td>
   <td style="text-align:center;"> Diagonal </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Equal </td>
  </tr>
  <tr>
   <td style="text-align:center;"> EVE </td>
   <td style="text-align:center;"> $$\lambda DA_kD^T$$ </td>
   <td style="text-align:center;"> Ellipsoidal </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Equal </td>
  </tr>
  <tr>
   <td style="text-align:center;"> VEE </td>
   <td style="text-align:center;"> $$\lambda_k DAD^T$$ </td>
   <td style="text-align:center;"> Ellipsoidal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Equal </td>
  </tr>
  <tr>
   <td style="text-align:center;"> VVE </td>
   <td style="text-align:center;"> $$\lambda_k DA_kD^T$$ </td>
   <td style="text-align:center;"> Ellipsoidal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Equal </td>
  </tr>
  <tr>
   <td style="text-align:center;"> EEV </td>
   <td style="text-align:center;"> $$\lambda D_kAD_k^T$$ </td>
   <td style="text-align:center;"> Ellipsoidal </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Variable </td>
  </tr>
  <tr>
   <td style="text-align:center;"> VEV </td>
   <td style="text-align:center;"> $$\lambda_k D_kAD_k^T$$ </td>
   <td style="text-align:center;"> Ellipsoidal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Variable </td>
  </tr>
  <tr>
   <td style="text-align:center;"> EVV </td>
   <td style="text-align:center;"> $$\lambda D_kA_kD_k^T$$ </td>
   <td style="text-align:center;"> Ellipsoidal </td>
   <td style="text-align:center;"> Equal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Variable </td>
  </tr>
  <tr>
   <td style="text-align:center;"> VVV </td>
   <td style="text-align:center;"> $$\lambda_k D_kA_kD_k^T$$ </td>
   <td style="text-align:center;"> Ellipsoidal </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Variable </td>
   <td style="text-align:center;"> Variable </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note the distribution descriptions “spherical” and “ellipsoidal”. These are descriptions of the shape of the variance-covariance for a multivariate normal distribution. A standard multivariate normal distribution has a variance-covariance matrix with zeros in the off-diagonal elements, which corresponds to spherically shaped data. When the variances (diagonals) are different or the variables are correlated, then the shape of data from a multivariate normal is ellipsoidal.</p>
<p></p>
<p>The models are typically scored using the Bayes Information Criterion (BIC), which is based on the log likelihood, number of variables, and number of mixture components. They should also be assessed using graphical methods, as we demonstrate using the data.</p>
</section>
<section id="two-variables" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="two-variables"><span class="header-section-number">11.2</span> Two variables</h2>
<p>We start with two of the four real-valued variables (<code>bl</code>, <code>fl</code>) and the three <code>species</code>. The goal is to determine whether model-based methods can discover clusters that closely correspond to the three species. Based on the scatterplot in <a href="#fig-penguins-bl-fl">Figure&nbsp;<span>11.1</span></a> we would expect it to do well, and suggest an elliptical variance-covariance of roughly equal sizes as the model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/penguins_sub.rda"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_sub, <span class="fu">aes</span>(<span class="at">x=</span>bl, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y=</span>fl)) <span class="sc">+</span> <span class="co">#, </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#colour=species)) +</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density2d</span>() <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_discrete_qualitative("Dark 3") +</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-penguins-bl-fl" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="model-based-clustering_files/figure-html/fig-penguins-bl-fl-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;11.1: Scatterplot of flipper length by bill length of the penguins data.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>penguins_BIC <span class="ot">&lt;-</span> <span class="fu">mclustBIC</span>(penguins_sub[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ggmc <span class="ot">&lt;-</span> <span class="fu">ggmcbic</span>(penguins_BIC, <span class="at">cl=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">top=</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"(a)"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>penguins_mc <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(penguins_sub[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)], </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">G=</span><span class="dv">3</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">modelNames =</span> <span class="st">"EVE"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>penguins_mce <span class="ot">&lt;-</span> <span class="fu">mc_ellipse</span>(penguins_mc)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>penguins_cl <span class="ot">&lt;-</span> penguins_sub[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>penguins_cl<span class="sc">$</span>cl <span class="ot">&lt;-</span> <span class="fu">factor</span>(penguins_mc<span class="sc">$</span>classification)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>ggell <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">data=</span>penguins_cl, <span class="fu">aes</span>(<span class="at">x=</span>bl, <span class="at">y=</span>fl,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">colour=</span>cl),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">data=</span>penguins_mce<span class="sc">$</span>ell, <span class="fu">aes</span>(<span class="at">x=</span>bl, <span class="at">y=</span>fl,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">colour=</span>cl),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">shape=</span><span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">data=</span>penguins_mce<span class="sc">$</span>mn, <span class="fu">aes</span>(<span class="at">x=</span>bl, <span class="at">y=</span>fl,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">colour=</span>cl),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">shape=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete_qualitative</span>(<span class="at">palette =</span> <span class="st">"Dark 3"</span>) <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, <span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"(b)"</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>ggmc <span class="sc">+</span> ggell <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-penguins-bl-fl-mc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="model-based-clustering_files/figure-html/fig-penguins-bl-fl-mc-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;11.2: Summary plots from model-based clustering: (a) BIC values for clusters 2-9 of top four models, (b) variance-covariance ellipses and cluster means (+) corresponding to the best model. The best model is three-cluster EVE, which has differently shaped variance-covariances albeit the same volume and orientation.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><a href="#fig-penguins-bl-fl-mc">Figure&nbsp;<span>11.2</span></a> summarises the results. All models agree that three clusters is the best. The different variance-covariance models for three clusters have similar BIC values with EVE (different shape, same volume and orientation) being slightly higher. These plots are made from the <code>mclust</code> package output using the <code>ggmcbic</code> and <code>mc_ellipse</code> functions fro the <code>mulgar</code> package.</p>
</section>
<section id="high-dimensions" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="high-dimensions"><span class="header-section-number">11.3</span> High-dimensions</h2>
<p>Now we will examine how model-based clustering will group the penguins data using all four variables.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>penguins_BIC <span class="ot">&lt;-</span> <span class="fu">mclustBIC</span>(penguins_sub[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ggmc <span class="ot">&lt;-</span> <span class="fu">ggmcbic</span>(penguins_BIC, <span class="at">cl=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">top=</span><span class="dv">7</span>) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ggmc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-penguins-bic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="model-based-clustering_files/figure-html/fig-penguins-bic-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;11.3: BIC values for the top models for 2-9 clusters on the penguins data. The interpretation is mixed: if one were to choose three clusters any of the variance-covariance models would be equally as good, but the very best model is the four-cluster VEE.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>penguins_mc <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(penguins_sub[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">G=</span><span class="dv">4</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">modelNames =</span> <span class="st">"VEE"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>penguins_mce <span class="ot">&lt;-</span> <span class="fu">mc_ellipse</span>(penguins_mc)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>penguins_cl <span class="ot">&lt;-</span> penguins_sub</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>penguins_cl<span class="sc">$</span>cl <span class="ot">&lt;-</span> <span class="fu">factor</span>(penguins_mc<span class="sc">$</span>classification)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>penguins_mc_data <span class="ot">&lt;-</span> penguins_cl <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bl<span class="sc">:</span>bm, cl) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">bind_cols</span>(penguins_mce<span class="sc">$</span>ell,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type=</span><span class="fu">rep</span>(<span class="st">"ellipse"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">nrow</span>(penguins_mce<span class="sc">$</span>ell)))) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">animate_xy</span>(penguins_mc_data[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">col=</span>penguins_mc_data<span class="sc">$</span>cl,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">20</span> )[<span class="fu">as.numeric</span>(penguins_mc_data<span class="sc">$</span>type)], </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">axes=</span><span class="st">"off"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/penguins_tour_path.rda"</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fu">render_gif</span>(penguins_mc_data[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">planned_tour</span>(pt1), </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>           <span class="fu">display_xy</span>(<span class="at">col=</span>penguins_mc_data<span class="sc">$</span>cl,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">20</span>)[</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">as.numeric</span>(penguins_mc_data<span class="sc">$</span>type)], </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">axes=</span><span class="st">"off"</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">half_range =</span> <span class="fl">0.7</span>),</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">gif_file=</span><span class="st">"gifs/penguins_best_mc.gif"</span>,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">frames=</span><span class="dv">500</span>,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">loop=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>penguins_mc <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(penguins_sub[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">G=</span><span class="dv">3</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">modelNames =</span> <span class="st">"EEE"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>penguins_mce <span class="ot">&lt;-</span> <span class="fu">mc_ellipse</span>(penguins_mc)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>penguins_cl <span class="ot">&lt;-</span> penguins_sub</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>penguins_cl<span class="sc">$</span>cl <span class="ot">&lt;-</span> <span class="fu">factor</span>(penguins_mc<span class="sc">$</span>classification)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>penguins_mc_data <span class="ot">&lt;-</span> penguins_cl <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bl<span class="sc">:</span>bm, cl) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">bind_cols</span>(penguins_mce<span class="sc">$</span>ell,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type=</span><span class="fu">rep</span>(<span class="st">"ellipse"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">nrow</span>(penguins_mce<span class="sc">$</span>ell)))) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">animate_xy</span>(penguins_mc_data[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">col=</span>penguins_mc_data<span class="sc">$</span>cl,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">20</span>)[<span class="fu">as.numeric</span>(penguins_mc_data<span class="sc">$</span>type)], </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">axes=</span><span class="st">"off"</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the animated gif</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/penguins_tour_path.rda"</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">render_gif</span>(penguins_mc_data[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">planned_tour</span>(pt1), </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>           <span class="fu">display_xy</span>(<span class="at">col=</span>penguins_mc_data<span class="sc">$</span>cl,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">20</span>)[</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">as.numeric</span>(penguins_mc_data<span class="sc">$</span>type)], </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">axes=</span><span class="st">"off"</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">half_range =</span> <span class="fl">0.7</span>),</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">gif_file=</span><span class="st">"gifs/penguins_simpler_mc.gif"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">frames=</span><span class="dv">500</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">loop=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fig-penguins-mc" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-penguins-best_mc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="gifs/penguins_best_mc.gif" class="img-fluid figure-img" data-fig.align="center" alt="FIX ME" data-ref-parent="fig-penguins-mc"></p>
<p></p><figcaption class="figure-caption">(a) Best model: four-cluster VEE</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-penguins-simpler_mc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="gifs/penguins_simpler_mc.gif" class="img-fluid figure-img" data-fig.align="center" alt="FIX ME" data-ref-parent="fig-penguins-mc"></p>
<p></p><figcaption class="figure-caption">(b) Three-cluster EEE</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;11.4: Examining the model-based clustering results for the penguins data: (a) best model according to BIC value, (b) simpler three-cluster model. Dots are ellipse points, and “x” are data points. It is important to note that the three cluster solution fits the data better, even though it has a lower BIC.</figcaption><p></p>
</figure>
</div>
<div class="cell">

</div>

<!--
@fig-model-based1 contains the plots we will use to examine the results of model-based clustering on this reduced dataset. The top leftmost plot shows the data, with male and female crabs distinguished by color and
glyph. The two sexes correspond to long cigar-shaped objects that overlap a bit, particularly for smaller crabs. The "cigars" are not perfectly regular: The variance of the data is smaller at small values
for both sexes, so that our cigars are somewhat wedge-shaped. The orientation of the longest direction of variance differs slightly between groups too: The association has a steeper slope for female crabs
than for males, because female crabs have relatively larger `rear width` than male crabs. With the heterogeneity in variance-covariance, this
data does not strictly adhere to the multivariate normal mixture model underlying model-based methods, but we hope that the departure from regularity is not so extreme that it prevents the model from working.

The top right plot shows the BIC results for a full range of models,
EEE, EEV, and VVV variance-covariance parametrization for one to nine
clusters:

    > blue.crabBIC <- mclustBIC(subset(d.blue.crabs,
        select=c(FL,RW)), modelNames=c("EEE","EEV","VVV"))
    > blue.crabBIC
     BIC:
            EEE       EEV       VVV
    1 -810.3289 -810.3289 -810.3289
    2 -820.7272 -778.6450 -783.7705
    3 -832.7712 -792.5937 -821.8645
    4 -824.8927 -835.5631 -835.7799
    5 -805.8402 -805.9425 -853.1395
    6 -807.8380 -821.1586 -879.3500
    7 -827.1099 -860.7258 -878.0679
    8 -833.8051 -861.1460 -891.9757
    9 -835.6620 -854.6120 -904.6108
    > plot(blue.crabBIC)
    EEE EEV VVV 
     15  12   0 

\noindent  The best model, EEV-2, used the equal volume, equal shape,
and different orientation variance--covariance parametrization and
divided the data into two clusters. This solution seems to be perfect!
We can imagine that this result corresponds to two equally shaped
ellipses that intersect near the lowest values of the data and angle
toward higher values. We will check by drawing ellipses representing the
variance--covariance parametrization on the data plots. The parameter
estimates are used to scale and center the ellipses:

    > mclst1 <- mclustBIC(subset(d.blue.crabs,
        select=c(FL,RW)), G=2, modelNames="EEV")
    > mclst1
     BIC:
           EEV
    2 -778.645
    > smry1 <- mclustModel(subset(d.blue.crabs,
        select=c(FL,RW)), mclst1, G=2, modelNames="EEV")
    > vc <- smry1$parameters$variance$sigma[,,1]
    > xm <- smry1$parameters$mean[,1]
    > y1 <- f.vc.ellipse(vc,xm,500)
    > ...

\noindent yielding the plots in the middle and bottom rows of
@fig-model-based1. In the plot of the data alone, cluster id is used for
the color and glyph of points. (Compare this plot with the one directly
above it, in which the classes are known.) Cluster 1 mostly corresponds
to the female crabs, and cluster 2 to the males, except that all the
small crabs, both male and female, have been assigned to cluster 1. In
the rightmost plot, we have added ellipses representing the estimated
variance--covariances. The ellipses are the same shape, as specified by
the model, but the ellipse for cluster 2 is shifted toward the large
values.

The next two best models, according to the BIC values, are EEV-3 and
VVV-2. The plots in the bottom row display representations of the
variance--covariances for these models. EEV-3 organizes the crabs into
three clusters according to the size, not the sex, of the crabs. The
VVV-2 solution is similar to EEV-2.

What solution is the best for this data? If the EEV-3 model had done
what we intuitively expected, it would have been ideal: The sexes of
smaller crabs are indistinguishable, so they should be afforded their
own cluster, whereas larger crabs could be clustered into males and
females. However, the cluster that includes the small crabs also
includes a fair number of middle-sized female crabs.

Finally, model-based clustering did not discover the true gender
clusters. Still, it produced a useful and interpretable clustering of
the crabs.

Plots are indispensable for choosing an appropriate cluster model. It is
easy to visualize the models when there are only two variables but
increasingly difficult as the number of variables grows. Tour methods
save us from producing page upon page of plots. They allow us to look at
many projections of the data, which enables us to conceptualize the
shapes and relationships between clusters in more than two dimensions.


@fig-model-based2 displays the graphics for the corresponding
high-dimensional investigation using all five variables and four classes
(two species, two sexes) of the \Data{Australian Crabs}. The cluster
analysis is much more difficult now. Can model-based clustering uncover
these four groups?

In the top row of plots, we display the raw data, before modeling. Each
plot is a tour projection of the data, colored according to the four
true classes. The blue and purple points are the male and female crabs
of the blue species, and the yellow and orange points are the male and
female crabs of the orange species. This table will help you keep track:



```{=html}
\begin{center}
\begin{tabular}{l@{\hspace{.1in}}l@{\hspace{.1in}}l} \hline
\T \B & Male & Female \\ \hline
\T Blue Species & blue rectangles & purple circles \\ 
\B Orange Species & yellow circles & orange rectangles \\\hline
\end{tabular}
\end{center}
```



The clusters corresponding to the classes are long thin wedges in five
dimensions (5D), with more separation and more variability at larger
values, as we saw in the subset just discussed. The rightmost plot shows
the looking down the barrel'' view of the wedges. At small values
the points corresponding to the sexes are mixed (leftmost plot). The
species are reasonably well separated even for small crabs (middle
plot). The variance--covariance is wedge-shaped rather than elliptical,
but again we hope that modeling based on the normal distribution that
has elliptical variance--covariance will be adequate.



```{=html}
% Figure 7
\begin{figure*}[htbp]
\centerline{{\includegraphics[width=1.5in]{chap-clust/crabs7.pdf}}
 {\includegraphics[width=1.5in]{chap-clust/crabs9.pdf}}
 {\includegraphics[width=1.5in]{chap-clust/crabs11.pdf}}}
\smallskip
\centerline{{\includegraphics[width=1.5in]{chap-clust/crabs8.pdf}}
 {\includegraphics[width=1.5in]{chap-clust/crabs10.pdf}}
 {\includegraphics[width=1.5in]{chap-clust/crabs12.pdf}}}
\caption[Comparing the \Data{Australian Crabs} data with results of
model-based clustering]{Comparing the \Data{Australian Crabs} data
with results of model-based clustering using all variables.  Compare
the tour projections of the 5D data {\bf (top row)} with the 5D ellipses
corresponding to the variance--covariance in the four-cluster model
{\bf (bottom row)}. The ellipses of the four clusters do not match the four
known groups in the data.}
\label{model-based2}
\end{figure*}
```



In the results from model-based clustering, there is very little
difference in BIC value for variance--covariance models EEE, EEV, VEV,
and VVV, with a number of clusters from three to eight. The best model
is EEV-3, and EEV-4 is second best. We know that three clusters is
insufficient to capture the four classes we have in mind, so we examine
the four-cluster solution.

    > mclst4 <- mclustBIC(subset(d.blue.crabs,select=c(FL:BD)),
        G=1:8, modelNames=c("EEE","EEV","VVV"))
    > plot(mclst4)
    EEE EEV VVV 
     15  12   0 
    > mclst5 <- mclustBIC(subset(d.blue.crabs,select=c(FL:BD)), 
       G=4, modelNames="EEV")
    > smry5 <- mclustModel(subset(d.blue.crabs,select=c(FL:BD)), 
       mclst5, G=4, modelNames="EEV")

The bottom row of plots in @fig-model-based2 illustrates the
four-cluster model in three different projections, matching the
projections in the top row showing the data.

    > vc <- smry5$parameters$variance$sigma[,,1]
    > mn <- smry5$parameters$mean[,1]
    > y1 <- f.vc.ellipse(vc, mn)
    > ...
    > mclst5.model <- cbind(matrix(NA,500*4,3),
        rbind(y1,y2,y3,y4))
    > colnames(mclst5.model) <-
        c("Species","Sex","Index","FL","RW","CL","CW","BD")
    > d.crabs.model <- rbind(d.crabs, mclst5.model)
    > gd <- ggobi(d.crabs.model)[1]
    > glyph_color(gd) <- c(rep(4,50), rep(1,50), rep(9,50), 
        rep(6,50), rep(8,2000))

\noindent In each view, the ellipsoids representing the
variance--covariance estimates for the four clusters are shown in four
shades of gray, because none of these match any actual cluster in the
data. Remember that these are 2D projections of 5D ellipsoids. The
resulting clusters from the model do not match the true classes very
well. The result roughly captures the two species, as we see in the
plots in the first column, where the species are separated both in the
data and in the ellipses. On the other hand, the grouping corresponding
to \Vbl{sex} is completely missed: See the plots in the middle and
right-hand columns, where sexes are separated in the actual data but the
ellipses are not separated. Just as in the smaller subset (two
variables, one species) discussed earlier, there is a cluster for the
smaller crabs of both species and sexes. The results of model-based
clustering on the full 5D data are very unsatisfactory.

In summary, plots of the data and parameter estimates for model-based
cluster analysis are very useful for understanding the solution, and
choosing an appropriate model. Tours are very helpful for examining the
results in higher dimensions, for arbitrary numbers of variables.

-->


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-FR02" class="csl-entry" role="doc-biblioentry">
Fraley, C., and A. E. Raftery. 2002. <span>“Model-Based <span>C</span>lustering, <span>D</span>iscriminant <span>A</span>nalysis, <span>D</span>ensity <span>E</span>stimation.”</span> <em>Journal of the American Statistical Association</em> 97: 611–31.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./kmeans-clustering.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">k-means clustering</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./som.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Self-organizing maps</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>