<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Neural networks and deep learning | Interactive and dynamic graphics for multivariate data using R</title>
  <meta name="description" content="This is a book about exploring multivariate data." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Neural networks and deep learning | Interactive and dynamic graphics for multivariate data using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book about exploring multivariate data." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Neural networks and deep learning | Interactive and dynamic graphics for multivariate data using R" />
  
  <meta name="twitter:description" content="This is a book about exploring multivariate data." />
  

<meta name="author" content="Di Cook, Ursula Laa, Stuart Lee, Earo Wang" />


<meta name="date" content="2021-02-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="trees-and-forests.html"/>
<link rel="next" href="hierarchical-clustering.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i><b>2</b> Toolbox</a></li>
<li class="chapter" data-level="3" data-path="dimension-reduction.html"><a href="dimension-reduction.html"><i class="fa fa-check"></i><b>3</b> Dimension reduction</a></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data</a></li>
<li class="chapter" data-level="5" data-path="regression-methods.html"><a href="regression-methods.html"><i class="fa fa-check"></i><b>5</b> Regression methods</a><ul>
<li class="chapter" data-level="5.1" data-path="regression-methods.html"><a href="regression-methods.html#support-vector-machine"><i class="fa fa-check"></i><b>5.1</b> Support vector machine</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-discriminant-analysis-and-manova.html"><a href="linear-discriminant-analysis-and-manova.html"><i class="fa fa-check"></i><b>6</b> Linear discriminant analysis and MANOVA</a></li>
<li class="chapter" data-level="7" data-path="trees-and-forests.html"><a href="trees-and-forests.html"><i class="fa fa-check"></i><b>7</b> Trees and forests</a><ul>
<li class="chapter" data-level="7.1" data-path="trees-and-forests.html"><a href="trees-and-forests.html#trees"><i class="fa fa-check"></i><b>7.1</b> Trees</a></li>
<li class="chapter" data-level="7.2" data-path="trees-and-forests.html"><a href="trees-and-forests.html#random-forests"><i class="fa fa-check"></i><b>7.2</b> Random forests</a></li>
<li class="chapter" data-level="" data-path="trees-and-forests.html"><a href="trees-and-forests.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="neural-networks-and-deep-learning.html"><a href="neural-networks-and-deep-learning.html"><i class="fa fa-check"></i><b>8</b> Neural networks and deep learning</a></li>
<li class="chapter" data-level="9" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html"><i class="fa fa-check"></i><b>9</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="10" data-path="k-means-clustering.html"><a href="k-means-clustering.html"><i class="fa fa-check"></i><b>10</b> k-means clustering</a></li>
<li class="chapter" data-level="11" data-path="model-based-clustering.html"><a href="model-based-clustering.html"><i class="fa fa-check"></i><b>11</b> model-based clustering</a></li>
<li class="chapter" data-level="12" data-path="multivariate-time-series.html"><a href="multivariate-time-series.html"><i class="fa fa-check"></i><b>12</b> Multivariate time series</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactive and dynamic graphics for multivariate data using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="neural-networks-and-deep-learning" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Neural networks and deep learning</h1>
<p></p>
<p>Neural networks for classification can be thought of as additive
models where explanatory variables are transformed, usually through a
logistic function, added to other explanatory variables, transformed
again, and added again to yield class predictions. Aside from the data
mining literature, mentioned earlier, a good comprehensive and
accessible description for statisticians can be found in
. The model can be formulated as:</p>
<p><span class="math display">\[
\hat{y} = f(x) = \phi(\alpha+\sum_{h=1}^{s}
w_{h}\phi(\alpha_h+\sum_{i=1}^{p} w_{ih}x_i))
\]</span></p>
<p></p>
<p>where <span class="math inline">\(x\)</span> is the vector of explanatory variable values, <span class="math inline">\(y\)</span>
is the target value, <span class="math inline">\(p\)</span> is the number of variables, <span class="math inline">\(s\)</span> is the number
of nodes in the single hidden layer, and <span class="math inline">\(\phi\)</span> is a fixed function,
usually a linear or logistic function. This model has a single hidden
layer and univariate output values. The model is fit by minimizing
the sum of squared differences between observed values and fitted
values, and the minimization does not always converge. A neural
network is a black box that accepts inputs, computes, and spits out
predictions. With graphics, some insight into the black box can be
gained. We use the feed-forward neural network provided in the {
nnet} package of R  to illustrate.</p>
<p>We continue to work with , and we look at the
performance of the neural network in classifying the oils in the four
areas of the South, a difficult challenge. Because the software
does not include a method for computing the predictive error, we break
the data into training and test samples so we can better estimate the
predictive error. (We could tweak the neural network to perfectly fit
all the data, but then we could not estimate how well it would perform
with new data.)</p>

<p>% this may need a few more words</p>
<p>After trying several values for <span class="math inline">\(s\)</span>, the number of nodes in the hidden
layer, we chose <span class="math inline">\(s=4\)</span>; we also chose a linear <span class="math inline">\(\phi\)</span>, <span class="math inline">\(decay=0.005\)</span>,
and <span class="math inline">\(range=0.06\)</span>. We fit the model using many different random
starting values, rejecting the results until it eventually converged
to a solution with a reasonably low error:</p>

% Insert page break to avoid breaking the R output.

<p>Below are the misclassification tables for the training and test
samples.</p>







<p>The training error is <span class="math inline">\(9/246=0.037\)</span>, and the test error is
<span class="math inline">\(12/77=0.156\)</span>. The overall errors, as in the random forest model, are
not uniform across classes. This is particularly obvious in the test
error table: The error in classifying North Apulian oils is close to a
third, and it is even worse for Sicilian oils, which have an almost
even chance of being misclassified.</p>
<p>Our exploration of the misclassifications is shown in
Fig.~. (The troublesome Sicilian oils have been
excluded from all plots in this figure.) Consider first the plots in
the top row. The left-hand plot shows the misclassification table.
Two samples of oils from North Apulia (orange <span class="math inline">\(+\)</span>) have been
incorrectly classified as South Apulian (pink <span class="math inline">\(\times\)</span>), and these two
points have been brushed as filled orange circles. Note where these
points fall in the next two plots, which are linked 2D tour
projections.  One of the two
misclassified points is on the edge of the cluster of North Apulian
points, close to the Calabrian cluster. It is understandable that
there might be some confusion about this case. The other sample is on
the outer edge of the North Apulian cluster, but it is far from the
Calabrian cluster <sub>—</sub> this should not have been confused.</p>
% Figure 13

<p>In the bottom row of plots, we follow the same procedure to examine
the single North Apulian sample misclassified as South Apulian. It is
painted as a filled orange circle in the misclassification plot and
viewed in a  tour. This point is on the outer edge
of the North Apulian cluster, but it is closer to the Calabrian cluster
than the South Apulian cluster. It would be understandable for it to
be misclassified as Calabrian, so it is puzzling that it is
misclassified as South Apulian.</p>
<p>In summary, a neural network is a black box method for tackling tough
classification problems. It will generate different solutions each
time the net is fit, some much better than others. When numerical
measures suggest that a reasonable model has been found, graphics can
be used to inspect the model in more detail.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="trees-and-forests.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hierarchical-clustering.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["mulgar.pdf", "mulgar.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
