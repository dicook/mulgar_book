{
  "hash": "17758fb3c76323b5a7101e1c45088904",
  "result": {
    "engine": "knitr",
    "markdown": "# Linear discriminant analysis {#sec-lda}\n\\index{classification!linear discriminant analysis (LDA)}\n\nLinear discriminant analysis (LDA) dates to the early 1900s. It's one of the most elegant and simple techniques for both modeling separation between groups, and as an added bonus, producing a low-dimensional representation of the differences between groups. LDA has two strong assumptions: the groups are samples from multivariate normal distributions, and each have the same variance-covariance. If the latter assumption is relaxed, a slightly less elegant solution results from quadratic discriminant analysis.\n\nUseful explanations can be found in @VR02 and @Ri96. A good general treatment of parametric methods for supervised classification can be found in @JW02 or another similar multivariate analysis textbook. It's also useful to know that hypothesis testing for the difference in multivariate means using multivariate analysis of variance (MANOVA) has similar assumptions to LDA. Also model-based clustering assumes that each cluster arises from a multivariate normal distribution, and is related to LDA. The methods described here can be used to check these assumptions when applying these methods, too.\\index{classification!multivariate analysis of variance (MANOVA)} \\index{cluster analysis!model-based} \n\n::: {.content-visible when-format=\"html\"}\n::: info\nBecause LDA is a parametric model it is important to check that these assumptions are reasonably satisfied:\n\n- shape of clusters are elliptical.\n- spread of the observations are the same.\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\infobox{Because LDA is a parametric model it is important to check that these assumptions are reasonably satisfied:\n\\begin{itemize} \\itemsep 0in\n\\item shape of clusters are elliptical.\n\\item spread of the observations are the same.\n\\end{itemize}\n}\n:::\n\n<!-- Algorithmic methods have overtaken parametric methods in the practice of supervised classification.  A parametric method such as linear discriminant analysis (LDA) yields a set of interpretable output parameters, so it leaves a clear trail helping us to understand what was done to produce the results.  An algorithmic method, on the other hand, is more or less a black box, with various input parameters that are adjusted to tune the algorithm.  The algorithm's input and output parameters do not always correspond in any obvious way to the interpretation of the results.  Because if it's simplicity, if the assumptions (approximately) hold, LDA can provide an elegant classification solution.-->\n\n## Extracting the key elements of the model\n\nLDA builds the model on the between-group sum-of-square matrix\n\n$$B=\\sum_{k=1}^g n_k(\\bar{X}_k-\\bar{X})(\\bar{X}_k-\\bar{X})^\\top$$\nwhich measures the differences between the class means, \ncompared with the overall data mean $\\bar{X}$ and the within-group sum-of-squares matrix,\n\n$$\nW =\n\\sum_{k=1}^g\\sum_{i=1}^{n_k}\n(X_{ki}-\\bar{X}_k)(X_{ki}-\\bar{X}_k)^\\top\n$$\n\nwhich measures the variation of values around each class mean. The linear discriminant space is generated by computing the eigenvectors (canonical coordinates) of $W^{-1}B$, and this is the $(g-1)$-D space where the group means are most separated with respect to the\npooled variance-covariance. For each class we compute\n\\index{classification!discriminant space}\n\n$$\n\\delta_k(x) = (x-\\mu_k)^\\top W^{-1}\\mu_k + \\log \\pi_k\n$$\n\nwhere $\\pi_k$ is a prior probability for class $k$ that might be based on unequal sample sizes, or cost of misclassification. The LDA classifier rule is to *assign a new observation to the class with the largest value* of $\\delta_k(x)$.\n\nWe can fit an LDA model using the `lda()` function from the `MASS` package. Here we have used the `penguins` data, assuming equal prior probability, to illustrate. \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Code to fit the model\nlibrary(dplyr)\nlibrary(mulgar)\nlibrary(MASS)\nload(\"data/penguins_sub.rda\")\n\np_lda <- lda(species~bl+bd+fl+bm, \n             data=penguins_sub,\n             prior=c(1/3, 1/3, 1/3))\noptions(digits=2)\n# p_lda\n```\n:::\n\n\n\nBecause there are three classes the dimension of the discriminant space is 2D. We can easily extract the group means from the model. \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Extract the sample means\np_lda$means\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             bl    bd    fl    bm\nAdelie    -0.95  0.60 -0.78 -0.62\nChinstrap  0.89  0.64 -0.37 -0.59\nGentoo     0.65 -1.10  1.16  1.10\n```\n\n\n:::\n:::\n\n\n\nThe coefficients to project the data into the discriminant space, that is the eigenvectors of $W^{-1}B$ are: \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Extract the discriminant space\np_lda$scaling\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     LD1   LD2\nbl -0.24 -2.31\nbd  2.04  0.19\nfl -1.20  0.08\nbm -1.22  1.24\n```\n\n\n:::\n:::\n\n\n\nand the predicted values, which include class predictions, and coordinates in the discriminant space are generated as:\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Extract the fitted values\np_lda_pred <- predict(p_lda, penguins_sub)\n```\n:::\n\n\n\nThe best separation between classes can be viewed from this object, which can be shown to match the original data projected using the `scaling` component of the model object (see @fig-p-lda).\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Code to generate LDA plots\"}\n# Check calculations from the fitted model, and equations\nlibrary(colorspace)\nlibrary(ggplot2)\nlibrary(ggpubr)\n# Using the predicted values from the model object\np_lda_pred_x1 <- data.frame(p_lda_pred$x)\np_lda_pred_x1$species <- penguins_sub$species\np_lda1 <- ggplot(p_lda_pred_x1, \n                 aes(x=LD1, y=LD2, \n                     colour=species)) + \n  geom_point() +\n  xlim(-6, 8) + ylim(-6.5, 5.5) +\n  scale_color_discrete_divergingx(\"Zissou 1\") +\n  ggtitle(\"(a)\") +\n  theme_minimal() +\n  theme(aspect.ratio = 1, legend.title = element_blank()) \n\n# matches the calculations done manually\np_lda_pred_x2 <- data.frame(as.matrix(penguins_sub[,1:4]) %*%\n                              p_lda$scaling)\np_lda_pred_x2$species <- penguins_sub$species\np_lda2 <- ggplot(p_lda_pred_x2, \n                 aes(x=LD1, y=LD2, \n                     colour=species)) + \n  geom_point() +\n  xlim(-6, 8) + ylim(-7, 5.5) +\n  scale_color_discrete_divergingx(\"Zissou 1\") +\n  ggtitle(\"(b)\") +\n  theme_minimal() +\n  theme(aspect.ratio = 1, legend.title = element_blank()) \nggarrange(p_lda1, p_lda2, ncol=2, \n          common.legend = TRUE, legend = \"bottom\")\n```\n\n::: {.cell-output-display}\n![Penguins projected into the 2D discriminant space, done two ways: (a) using the predicted values, (b) directly projecting using the model component. The scale is not quite the same but the projected data is identical in shape.](14-lda_files/figure-pdf/fig-p-lda-1.pdf){#fig-p-lda fig-pos='H' width=80%}\n:::\n:::\n\n\n\nThe $W$ and $B$ matrices cannot be extracted from the model object, so we need to compute these separately. We only need $W$ actually. It is useful to think of this as the pooled variance-covariance matrix. Because the assumption for LDA is that the population group variance-covariances are identical, we estimate this by computing them for each class and then averaging them to get the pooled variance-covariance matrix. It's laborious, but easy.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Compute pooled variance-covariance\np_vc_pool <- mulgar::pooled_vc(penguins_sub[,1:4],\n                               penguins_sub$species)\np_vc_pool\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     bl   bd   fl   bm\nbl 0.31 0.18 0.13 0.18\nbd 0.18 0.32 0.14 0.20\nfl 0.13 0.14 0.23 0.16\nbm 0.18 0.20 0.16 0.31\n```\n\n\n:::\n:::\n\n\n\nThis can be used to draw an ellipse corresponding to the pooled variance-covariance that is used by the LDA model.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n## Checking assumptions\n\nThis LDA approach is widely applicable, but it is useful\nto check the underlying assumptions on which it depends: (1) that the cluster structure corresponding to each class forms an ellipse, showing that the class is consistent with a sample from a multivariate normal distribution, and (2) that the variance of values around each mean is nearly the same. @fig-lda-assumptions1 and @fig-lda-assumptions2 illustrates two datasets, of which only one is consistent with these assumptions. Other parametric models, such as quadratic discriminant analysis or logistic regression, also depend on assumptions about the data which should be validated.  \\index{classification!quadratic discriminant analysis (QDA)} \\index{classification!logistic regression}\n\n::: {.content-visible when-format=\"html\"}\n::: info\nTo check the equal and elliptical variance-covariance assumption, generate points on the surface of an ellipse corresponding to the variance-covariance for each group. When watching these ellipses in a tour, they should similar in all projections.\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\infobox{To check the equal and elliptical variance-covariance assumption, generate points on the surface of an ellipse corresponding to the variance-covariance for each group. When watching these ellipses in a tour, they should similar in all projections.\n}\n:::\n\n\\index{classification!variance-covariance}\n\\index{variance-covariance}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Generate ellipses for each group's variance-covariance\np_ell <- NULL\nfor (i in unique(penguins_sub$species)) {\n  x <- penguins_sub %>% dplyr::filter(species == i)\n  e <- gen_xvar_ellipse(x[,1:2], n=150, nstd=1.5)\n  e$species <- i\n  p_ell <- bind_rows(p_ell, e)\n}\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Scatterplot of flipper length by bill length of the penguins data, and corresponding variance-covariance ellipses. There is a small amount of difference between the ellipses, but they are similar enough to be confident in assuming the population variance-covariances are equal.](14-lda_files/figure-pdf/fig-lda-assumptions1-1.pdf){#fig-lda-assumptions1 width=80%}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Scatterplot of distance to cfa and road for the bushfires data, and corresponding variance-covariance ellipses. There is a lot of difference between the ellipses, so it cannot be assumed that the population variance-covariances are equal.](14-lda_files/figure-pdf/fig-lda-assumptions2-1.pdf){#fig-lda-assumptions2 width=80%}\n:::\n:::\n\n\n\\index{data!bushfires}\n\n::: {.content-visible when-format=\"html\"}\n::: insight\nThe equal and elliptical variance-covariance assumption is reasonable for the penguins data because the ellipse shapes roughly match the spread of the data. It is not a suitable assumption for the bushfires data, because the spread is not elliptically-shaped and varies in size between groups.\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\n\\insightbox{The equal and elliptical variance-covariance assumption is reasonable for the penguins data because the ellipse shapes roughly match the spread of the data. It is not a suitable assumption for the bushfires data, because the spread is not elliptically-shaped and varies in size between groups.}\n:::\n\nThis approach extends to any dimension. We would use the same projection sequence to view both the data and the variance-covariance ellipses, as in @fig-penguins-lda-ellipses-pdf. It can be seen that there is some difference in the shape and size of the ellipses between species, in some projections, and also with the spread of points in the projected data. However, it is the differences are small, so it would be safe to assume that the population variance-covariances are equal.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n::: {.content-visible when-format=\"html\"}\n\n::: {#fig-penguins-lda-ellipses-html layout-ncol=2}\n\n![Data](gifs/penguins_lda1.gif){#fig-lda-4D-assumptions1 fig-alt=\"Animation showing a tour of the penguins data, with colour indicating species. The spread of points in each group is reasonably similar regardless of projection.\" width=300}\n\n![Variance-covariance ellipses](gifs/penguins_lda2.gif){#fig-lda-4D-assumptions2 fig-alt=\"Animation showing a tour of the ellipses corresponding to variance-covariance matrices for each species. The shape of the ellipse for each group is reasonably similar regardless of projection.\" width=300}\n\nChecking the assumption of equal variance-covariance matrices for the 4D penguins data. Each ellipse corresponds to the sample variance-covariance for each species.\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\n::: {#fig-penguins-lda-ellipses-pdf layout-ncol=2}\n![Data](images/penguins_lda1.png){#fig-lda-4D-assumptions1 fig-alt=\"Single frame from a tour of the penguins data, with colour indicating species. Each group has slightly negatively elliptical shaped spread.\"}\n\n![Variance-covariance ellipses](images/penguins_lda2.png){#fig-lda-4D-assumptions2 fig-alt=\"Single frame from a tour of the ellipses corresponding to variance-covariance matrices for each species. Each ellipse has a north-west to south-east oriention. The red group is slightly smaller and more elliptical than the other two groups.\"}\n\nChecking the assumption of equal variance-covariance matrices for the 4D penguins data. Each ellipse corresponds to the sample variance-covariance for each species.\n:::\n:::\n\nAs a further check, we could generate three ellipses corresponding to the pooled variance-covariance matrix, as would be used in the model, centered at each of the means. Overlay this with the data, as done in @fig-penguins-lda-pooled-pdf. Now you will compare the spread of the observations in the data, with the elliptical shape of the pooled variance-covariance. If it matches reasonably we can safely use LDA. This can also be done group by group when multiple groups make it difficult to view all together. \n\n::: {.content-visible when-format=\"html\"}\n\n::: info\nTo check the fit of the equal variance-covariance assumption, simulate points on the ellipse corresponding to the **pooled sample variance-covariance matrix**. Generate one for each group centered at the group mean, and compare with the data.\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\infobox{To check the fit of the equal variance-covariance assumption, simulate points on the ellipse corresponding to the \\emph{pooled sample variance-covariance matrix}. Generate one for each group centered at the group mean, and compare with the data.}\n:::\n\n\\index{classification!pooled variance-covariance}\n\\index{pooled variance-covariance}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code for adding ellipses to data\"}\n# Create an ellipse corresponding to pooled vc\npool_ell <- gen_vc_ellipse(p_vc_pool, \n                           xm=rep(0, ncol(p_vc_pool)))\n\n# Add means to produce ellipses for each species\np_lda_pool <- data.frame(rbind(\n  pool_ell +\n    matrix(rep(p_lda$means[1,],\n      each=nrow(pool_ell)), ncol=4),\n  pool_ell +\n    matrix(rep(p_lda$means[2,],\n      each=nrow(pool_ell)), ncol=4),\n  pool_ell +\n    matrix(rep(p_lda$means[3,],\n      each=nrow(pool_ell)), ncol=4)))\n# Create one data set with means, data, ellipses\np_lda_pool$species <- factor(rep(levels(penguins_sub$species),\n                          rep(nrow(pool_ell), 3)))\np_lda_pool$type <- \"ellipse\"\np_lda_means <- data.frame(\n  p_lda$means,\n  species=factor(rownames(p_lda$means)),\n                          type=\"mean\")\np_data <- data.frame(penguins_sub[,1:5], \n                     type=\"data\")\np_lda_all <- bind_rows(p_lda_means,\n                       p_data,\n                       p_lda_pool)\np_lda_all$type <- factor(p_lda_all$type, \n   levels=c(\"mean\", \"data\", \"ellipse\"))\nshapes <- c(3, 4, 20)\np_pch <- shapes[p_lda_all$type]\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n::: {.content-visible when-format=\"html\"}\n\n::: {#fig-penguins-lda-pooled-html layout-ncol=2}\n\n![All species](gifs/penguins_lda_pooled1.gif){#fig-lda-pooled1 fig-alt=\"Animation showing a tour of the pooled variance-covariance ellipse, computed for each species, overlaid on the data. The shape of the ellipse for each group is reasonably similar to the spread of the points in all projections.\" width=300}\n\n\n![Gentoo](gifs/penguins_lda_pooled2.gif){#fig-lda-pooled1 fig-alt=\"Animation showing a tour of the pooled variance-covariance ellipse overlaid on the data for the Gentoo penguins (red). The shape of the ellipse is reasonably similar to the spread of the points in all projections.\" width=300}\n\nChecking how the pooled variance-covariance matches the spread of points in each group.\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\n::: {#fig-penguins-lda-pooled-pdf layout-ncol=2}\n\n![All species](images/penguins_lda_pooled1.png){#fig-lda-pooled1 fig-alt=\"A single frame from a tour of the pooled variance-covariance ellipse, computed for each species, overlaid on the data. The ellipse has a north-east to south-west orientation, and is almost circular, and reasonably matched the spread of the points in each group.\"}\n\n![Gentoo](images/penguins_lda_pooled2.png){#fig-lda-pooled1 fig-alt=\"A single frame from a tour of the pooled variance-covariance ellipse overlaid on the data for the Gentoo penguins (red). The ellipse has a north-west to south-east orientation, and is relatively skinny. This roughly matches the spread of the points.\"}\n\nChecking how the pooled variance-covariance matches the spread of points in each group.\n:::\n\n:::\n\n::: {.content-visible when-format=\"html\"}\n\n::: insight\nFrom the tour, we can see that the assumption of equal elliptical variance-covariance is a reasonable assumption for the penguins data. In all projections the ellipse is reasonably matching the spread of the observations.\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\n\\insightbox{From the tour, we can see that the assumption of equal elliptical variance-covariance is a reasonable assumption for the penguins data. In all projections the ellipse is reasonably matching the spread of the observations.\n}\n:::\n\n## Examining results\n\nThe boundaries for a classification model can be examined by: \n\n1. generating a large number of test points in the domain of the data\n2. predicting the class for each test point\n\nWe'll look at this for 2D using the LDA model fitted to `bl`, and `bd` of the `penguins` data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\np_bl_bd_lda <- lda(species~bl+bd, data=penguins_sub, \n                                  prior = c(1/3, 1/3, 1/3))\n```\n:::\n\n\n\nThe fitted model means \n$\\bar{x}_{Adelie} = ($ -0.95, 0.6$)^\\top$, $\\bar{x}_{Chinstrap} = ($ 0.89, 0.64$)^\\top$, and $\\bar{x}_{Gentoo} = ($ 0.65, -1.1$)^\\top$ can be added to the plots. \n\nThe boundaries can be examined using the `explore()` function from the `classifly` package, which generates observations in the range of all values of`bl` and `bd` and predicts their class. @fig-lda-2D-boundary shows the resulting prediction regions, with the observed data and the sample means overlaid.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Compute points in domain of data and predict\nlibrary(classifly)\n\np_bl_bd_lda_boundaries <- explore(p_bl_bd_lda, penguins_sub)\np_bl_bd_lda_m1 <- ggplot(p_bl_bd_lda_boundaries) +\n  geom_point(aes(x=bl, y=bd, \n                 colour=species, \n                 shape=.TYPE), alpha=0.8) + \n  scale_color_discrete_divergingx(\"Zissou 1\") +\n  scale_shape_manual(values=c(46, 16)) +\n  theme_minimal() +\n  theme(aspect.ratio = 1, legend.position = \"none\")\n\np_bl_bd_lda_means <- data.frame(p_bl_bd_lda$means,\n                        species=rownames(p_bl_bd_lda$means))\np_bl_bd_lda_m1 +   \n  geom_point(data=p_bl_bd_lda_means, \n             aes(x=bl, y=bd), \n             colour=\"black\", \n             shape=3,\n             size=3) \n```\n\n::: {.cell-output-display}\n![Prediction regions of the LDA model for two variables of the three species of penguins indicated by the small points. Large points are the observations, and the sample mean of each species is represented by the plus. The boundaries between groups can be seen to be roughly half-way between the means, taking the elliptical spread into account, and mostly distinguishes the three species.](14-lda_files/figure-pdf/fig-lda-2D-boundary-1.pdf){#fig-lda-2D-boundary fig-pos='H' fig-alt='Square divided into three regions by the coloured points, primarily a wedge of yellow (Chinstrap) extending from the top right divides the other two groups. The regions mostly contain the observed values, with just a few over the boundary in the wrong region.' width=70%}\n:::\n:::\n\n\n\n\\index{classification!boundaries}\n\\index{tour!slice}\n\nThis approach can be readily extended to higher dimensions. One first fits the model with all four variables, and uses the `explore()` to generate points in the 4D space with predictions, generating a representation of the prediction regions. @fig-penguins-lda-boundaries-pdf(a) shows the results using a slice tour [@slicetour]. Points inside the slice are shown in larger size. The slice is made in the centre of the data, to show the boundaries in this neighbourhood. As the tour progresses we see a thin slice through the centre of the data, parallel with the projection plane. In most projections there is some small overlap of points between groups, which happens because we are examining a 4D object with 2D. The slice helps to alleviate this, allowing a focus on the boundaries in the centre of the cube. In all projections the boundaries between groups is linear, as would be expected when using LDA. We can also see that the model roughly divides the cube into three relatively equally-sized regions.\n\n@fig-penguins-lda-boundaries-pdf(b) shows the three prediction regions, represented by points in 4D, projected into the discriminant space. Linear boundaries neatly divide the full space, which is to be expected because the LDA model computes it's classification rules in this 2D space.  \n\\index{classification!discriminant space}\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n::: {.content-visible when-format=\"html\"}\n\n::: {#fig-penguins-lda-boundaries-html layout-ncol=2}\n\n![4D](gifs/penguins_lda_boundaries.gif){#fig-lda-4D-boundaries fig-alt=\"Animation plot, where three groups of coloured points can be seen. They roughly break the square into three regions with linear boundaries, which varies in each projection.\" width=300}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Discriminant space](14-lda_files/figure-pdf/fig-lda-2D-boundaries-1.pdf){#fig-lda-2D-boundaries fig-alt='Scatterplot of points divided neatly into three colour groups by linear boundaries. The regions are split at the middle, and with the boundary between blue and red, blue and yellow, and yellow and red, starting near 11, 4, and o\\'clock, respectively.' width=80%}\n:::\n:::\n\n\n\nExamining the boundaries produced by the LDA model in the full 4D with a slice tour (left) and in the discriminant space (right). Large points indicate observations within the slice, and dots are observations outside the slice. Focusing on the within-slice points, there is some overlap of points between regions in most views which represents the occlusion of 4D shapes when examining projections with thin slices. The linear boundaries are seen exactly in the discriminant space, that is they are orthogonal to these two dimensions.\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\n::: {#fig-penguins-lda-boundaries-pdf layout-ncol=2 fig-alt=\"FIX-ME\"}\n\n![4D](images/penguins_lda_boundaries.png){#fig-lda-4D-boundaries fig-alt=\"A scatterplot with large points showing roughly linear boundaries between three groups.\" width=200}\n\n![Discriminant space](images/fig-lda-2D-boundaries-1.png){#fig-lda-4D-ds fig-alt=\"Scatterplot of points divided neatly into three colour groups by linear boundaries. The regions are split at the middle, and with the boundary between blue and red, blue and yellow, and yellow and red, starting near 11, 4, and o'clock, respectively.\" width=200}\n\n\n\n::: {.cell}\n\n:::\n\n\n\nExamining the boundaries produced by the LDA model in the full 4D with a slice tour (left shows a single frame) and in the discriminant space (right). Large points indicate observations within the slice, and dots are observations outside the slice. Focusing on the within-slice points, there is some overlap of points between regions in most views which represents the occlusion of 4D shapes when examining projections with thin slices. The linear boundaries are seen exactly in the discriminant space, that is they are orthogonal to these two dimensions.\n:::\n:::\n\n\n::: {.content-visible when-format=\"html\"}\n::: insight\nFrom the tour, we can see that the LDA boundaries divide the classes only in the discriminant space. It is not using the space orthogonal to the 2D discriminant space. You can see this because the boundary is sharp in just one 2D projection, while most of the projections show some overlap of regions.\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\n\\insightbox{From the tour, we can see that the LDA boundaries divide the classes only in the discriminant space. It is not using the space orthogonal to the 2D discriminant space. You can see this because the boundary is sharp in just one 2D projection, while most of the projections show some overlap of regions.}\n:::\n\n## Exercises {-}\n\n1. For the `simple_clusters` compute the LDA model, and make a plot of the data, with points coloured by the class. Overlay variance-covariance ellipses, and a $+$ indicating the sample mean for each class. Is it reasonable to assume that the two classes are sampled from populations with the same variance-covariance?\n2. Examine the clusters corresponding to the classes in the `clusters` data set, using a tour. Based on the shape of the data is the assumption of equal variance-covariance reasonable?\n3. Examine the pooled variance-covariance for the `clusters` data, overlaid on the data in a tour on the 5D. Does it fit the variance of each cluster nicely?\n4. Fit an LDA model to the `simple_clusters` data. Examine the boundaries produced by the model, in 2D. \n5. Fit an LDA model to the `clusters` data. Examine the boundaries produced by the model in 5D.\n6. Assess the LDA assumptions for the `multicluster` data. Is LDA an appropriate model?\n7. Compute the first 12 PCs of the `sketches` data. Check the assumption of equal, elliptical variance-covariance of the 6 groups. Regardless of whether you decide that the assumption is satisfied or not, fit an LDA to the 12 PCs. Extract the discriminant space (the `x` component of the `predict` object), and examine the separation (or not) of the 6 groups in this 5D space. Is LDA providing a good classification model for this data?\n8. Even though the `bushfires` data does not satisfy the assumptions for LDA, fit LDA to the first five PCs. Examine the class differences in the 3D discriminant space. \n9. Compute the boundary between classes, for the LDA model where the prior probability reflects the sample size, and the LDA model where the priors are equal for all groups. How does the boundary between lightning caused fires and the other groups change?\n\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "14-lda_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}